<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>DDSAnalytics Predictive Model DS6306</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Project Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About Author</a>
</li>
<li>
  <a href="BeerCaseStudy.html">CaseStudy1</a>
</li>
<li>
  <a href="CaseStudy2.html">CaseStudy2</a>
</li>
<li>
  <a href="App_link.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">DDSAnalytics Predictive Model DS6306</h1>
<h4 class="date">8/10/2020</h4>

</div>


<div id="ddsanalytics" class="section level2">
<h2>DDSAnalytics</h2>
<p>This is brief analysis capturing the factors that affect attriction and montlhy income from the available data that is provided in the data set used for this study. the data set consist of 39 variables and 890 observations, using employeee data.</p>
<div id="attrition-prediction" class="section level3">
<h3>Attrition Prediction</h3>
<p>This is a look into the factors causing attrition. the variables TotalWorkingYears, JobInvolvement and OverTime were found to be adequate for classification, with a Sensitivity of 0.8952 and Specificity of 0.8750.</p>
<pre class="r"><code>splitPerc =.75
set.seed(7)
trainIndices = sample(1:dim(CS2)[1],round(splitPerc * dim(CS2)[1]))
trainCS2_A = CS2[trainIndices,]
testCS2_A = CS2[-trainIndices,]

classifications = knn(trainCS2_A[,c(&#39;TotalWorkingYears&#39;,&#39;JobInvolvement&#39;,&#39;OverTime&#39;)] ,testCS2_A[,c(&#39;TotalWorkingYears&#39;,&#39;JobInvolvement&#39; ,&#39;OverTime&#39;)],trainCS2_A$Attrition, prob = TRUE, k = 5)
table(testCS2_A$Attrition,classifications)</code></pre>
<pre><code>##      classifications
##        No Yes
##   No  188   1
##   Yes  22   7</code></pre>
<pre class="r"><code>confusionMatrix(table(testCS2_A$Attrition,classifications))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications
##        No Yes
##   No  188   1
##   Yes  22   7
##                                           
##                Accuracy : 0.8945          
##                  95% CI : (0.8459, 0.9319)
##     No Information Rate : 0.9633          
##     P-Value [Acc &gt; NIR] : 1               
##                                           
##                   Kappa : 0.3404          
##                                           
##  Mcnemar&#39;s Test P-Value : 3.042e-05       
##                                           
##             Sensitivity : 0.8952          
##             Specificity : 0.8750          
##          Pos Pred Value : 0.9947          
##          Neg Pred Value : 0.2414          
##              Prevalence : 0.9633          
##          Detection Rate : 0.8624          
##    Detection Prevalence : 0.8670          
##       Balanced Accuracy : 0.8851          
##                                           
##        &#39;Positive&#39; Class : No              
## </code></pre>
<pre class="r"><code>classifications2 = knn(trainCS2_A[,c(&#39;TotalWorkingYears&#39;,&#39;JobInvolvement&#39;,&#39;OverTime&#39;)] ,CS_NA[,c(&#39;TotalWorkingYears&#39;,&#39;JobInvolvement&#39; ,&#39;OverTime&#39;)],trainCS2_A$Attrition, prob = TRUE, k = 5)

CS_NA$Predict_Attrition &lt;- classifications2
Attrition_pred &lt;- CS_NA %&gt;% dplyr::select(ID,Predict_Attrition)</code></pre>
</div>
<div id="income-prediction" class="section level3">
<h3>Income Prediction</h3>
<p>This is a look into the factors for income prediction. First EDA is conducted on the data to check for correlation and confoundong factors.</p>
</div>
<div id="statistical-check" class="section level3">
<h3>Statistical Check</h3>
</div>
</div>
<div id="multiple-linear-regression-assumptions" class="section level2">
<h2>Multiple Linear regression Assumptions</h2>
<ol style="list-style-type: decimal">
<li>Linearity</li>
<li>Constant Variance</li>
<li>Normality</li>
<li>Independence. From box plots we can see that constant variance and linearity seems to be satisfied. Normality is satisfied by large sample size. there seems to be some correlation between total working years and job level however we see that these two variables are still very effective in the model.</li>
</ol>
<pre class="r"><code>CS2$Department &lt;- as.factor(CS2$Department)
boxplot(CS2$MonthlyIncome~CS2$Department, main=toupper(&quot;MonthlyIncome by Department&quot;), font.main=3, cex.main=1.2, xlab=&quot;Department&quot;, ylab=&quot;MonthlyIncome&quot;, font.lab=3, col=&quot;darkgreen&quot;)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>boxplot(CS2$MonthlyIncome~CS2$JobLevel, main=toupper(&quot;MonthlyIncome by JobLevel&quot;), font.main=3, cex.main=1.2, xlab=&quot;JobLevel&quot;, ylab=&quot;MonthlyIncome&quot;, font.lab=3, col=&quot;darkgreen&quot;)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-4-2.png" width="672" /> ### Pearson Correlation</p>
<pre class="r"><code>CS2$Department &lt;- as.numeric(CS2$Department)
CS2$JobLevel &lt;- as.numeric(CS2$JobLevel)
a = CS2 %&gt;% dplyr::select(Department, JobLevel,TotalWorkingYears)
cor(a)</code></pre>
<pre><code>##                    Department  JobLevel TotalWorkingYears
## Department         1.00000000 0.1032270       -0.01581234
## JobLevel           0.10322699 1.0000000        0.78075235
## TotalWorkingYears -0.01581234 0.7807524        1.00000000</code></pre>
<div id="lack-of-fit-test" class="section level3">
<h3>Lack of Fit Test</h3>
<p>A lack of fit test was conducted on the department varaible to check if the linear model well fitted to the seperate means model and it was found to be similar, hence the linear regrssion model is appropriate for this varibable in the model. P value was found to be 0.18 which is higher than the alpha level of 0.05</p>
<pre class="r"><code>Reduced &lt;- lm(MonthlyIncome ~ Department, data = CS2)
Full &lt;- lm(MonthlyIncome ~ 0 + as.factor(Department), data = CS2)
anova (Reduced,Full)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: MonthlyIncome ~ Department
## Model 2: MonthlyIncome ~ 0 + as.factor(Department)
##   Res.Df        RSS Df Sum of Sq      F Pr(&gt;F)
## 1    868 1.8332e+10                           
## 2    867 1.8294e+10  1  37799773 1.7914 0.1811</code></pre>
</div>
<div id="rmse" class="section level3">
<h3>RMSE</h3>
<p>After the analysis we found the RMSE price to be $1371.55</p>
<pre class="r"><code>CS_NS &lt;- CaseStudy2CompSet_No_Salary
CS_NS$Department &lt;- as.factor(CS_NS$Department)


model2 &lt;- lm(MonthlyIncome ~ TotalWorkingYears+Department +JobLevel, data = CS3)
rmse(CS3$MonthlyIncome, predict(model2, CS3))</code></pre>
<pre><code>## [1] 1371.554</code></pre>
</div>
<div id="residual-check" class="section level3">
<h3>Residual Check</h3>
<p>Checking the residual plot we can see the residuals are evenly spread, the qq plot shows there is no eveidence against normality, checking the residual plot there is no point that has both high leverage and high influence so there are no outliers, the studentised residuals are also even.</p>
<pre class="r"><code>CS2I_pred = predict(model2, interval = &#39;predict&#39;, newdata = CS_NS) 
CS_NS$Predict_Income &lt;- CS2I_pred[,1]

Predict_Income &lt;- CS_NS %&gt;% dplyr::select(ID,Predict_Income)

par(mfrow = c(2, 2))  # Split the plotting panel into a 2 x 2 grid
plot(model2)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="multiple-regression-model" class="section level3">
<h3>Multiple Regression Model</h3>
<p>The most significant variable for this model was job level followed by total working years, it was found that the sub-level sales in department provided low significance as compared to its relevance to the reference Department Human resources. However the overall model proved to be significant with a p value of &lt;0.0001 and an adjusted R^2 of 0.9105.</p>
<pre class="r"><code>summary(model2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ TotalWorkingYears + Department + 
##     JobLevel, data = CS3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5553.7  -827.7    22.8   780.3  4157.5 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                      -1418.23     248.40  -5.709 1.56e-08 ***
## TotalWorkingYears                   48.35      10.10   4.789 1.97e-06 ***
## DepartmentResearch &amp; Development  -302.23     239.71  -1.261  0.20770    
## DepartmentSales                   -724.49     247.48  -2.927  0.00351 ** 
## JobLevel                          3774.56      70.06  53.874  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1376 on 865 degrees of freedom
## Multiple R-squared:  0.9109, Adjusted R-squared:  0.9105 
## F-statistic:  2211 on 4 and 865 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="job-role-specific-trends" class="section level3">
<h3>Job Role specific Trends</h3>
<p>We can see that it seems sales executives have the best work life balance as they are the highest both in the better and best levels of this category. In the second plot we see that research scientist are the one that work most over time and sales representatives are following closely behind. Once again we see sales executives as the most involved in their jobs as the they are by far the highest in this area. and finally Sales executives are the most satisfied with their jobs with research scientist following closely behind</p>
<pre class="r"><code>W_CS3 &lt;- CS3 %&gt;% 
 count(JobRole, WorkLifeBalance) %&gt;% 
 group_by(JobRole) %&gt;% 
 transmute(WorkLifeBalance, Percentage=n/sum(n)*100)

ggplot(W_CS3, aes(fill=JobRole, y=Percentage, x=WorkLifeBalance)) + 
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>O_CS3 &lt;- CS3 %&gt;% 
 count(JobRole, OverTime) %&gt;% 
 group_by(JobRole) %&gt;% 
 transmute(OverTime, Percentage=n/sum(n)*100)

ggplot(O_CS3, aes(fill=JobRole, y=Percentage, x=OverTime)) + 
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code>J_CS3 &lt;- CS3 %&gt;% 
 count(JobRole, JobInvolvement) %&gt;% 
 group_by(JobRole) %&gt;% 
 transmute(JobInvolvement, Percentage=n/sum(n)*100)

ggplot(J_CS3, aes(fill=JobRole, y=Percentage, x=JobInvolvement)) + 
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<pre class="r"><code>B_CS3 &lt;- CS3 %&gt;% 
 count(JobRole, JobSatisfaction) %&gt;% 
 group_by(JobRole) %&gt;% 
 transmute(JobSatisfaction, Percentage=n/sum(n)*100)

ggplot(B_CS3, aes(fill=JobRole, y=Percentage, x=JobSatisfaction)) + 
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;)</code></pre>
<p><img src="CaseStudy2_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
